"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[88],{88:(At,S,s)=>{s.r(S),s.d(S,{ShoppingModule:()=>g});var u=s(6895),x=s(8811),L=s(6713),_=s(6088),Z=s(8739),p=s(671),k=s(5226),d=s.n(k),F=s(1913),t=s(4650),T=s(5412),y=s(7392),q=s(5078),C=s(8306),c=s(4006),Q=s(8905),P=s(4719),Y=s(6628),G=s(1443),M=s(6234),f=s(9549),w=s(284),O=s(4385),D=s(3238),A=s(4850),b=s(9602),B=s(9007);function j(o,i){if(1&o&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function E(o,i){if(1&o&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.businessName," ")}}class v{constructor(i,e,n,r,l,a){this.fb=i,this.pipeDate=e,this.serviceClient=n,this.serviceWarehouse=r,this.toastService=l,this.serviceSale=a,this.listWarehouse=[],this.listProvider=[],this.listSaleStatus=[],this.options=[],this.change=new t.vpe,this.setListProvider(),this.form=this.fb.group({amount:[null],warehouseId:[null],providerId:[null],dateInit:[null],dateEnd:[null]}),this.setListWarehouse(),this.setListStatus(),this.setClient()}control(i){return this.form.controls[i]}setListWarehouse(){this.serviceWarehouse.getAllWarehouse().subscribe(i=>{this.listWarehouse=i})}setListStatus(){this.serviceSale.getSaleStatus().subscribe(i=>{this.listSaleStatus=i})}setClient(){this.serviceClient.getAllClient().subscribe(i=>{this.options=i})}_filter(i){const e=(i=i?.firstName?i?.firstName:i).toLowerCase();return this.options.filter(n=>n.firstName.toLowerCase().includes(e))}setListProvider(){this.serviceWarehouse.getAllProvider().subscribe(i=>{this.listProvider=i})}save(){if(Object.values(this.form.value).every(e=>null===e))this.toastService.show("\xa1No hay criterio de busqueda!",3e3);else{const e=this.form.value;let n="&";null!=e.dateInit&&null!=e.dateEnd&&(n+="&DateInit="+this.pipeDate.transform(e.dateInit,"YYYY-MM-dd"),n+="&DateEnd="+this.pipeDate.transform(e.dateEnd,"YYYY-MM-dd")),null!=e.warehouseId&&(n+=(n.length>1?"&":"")+"WarehouseId="+e.warehouseId),null!=e.providerId&&(n+=(n.length>1?"&":"")+"ProviderId="+e.providerId),null!=e.amount&&(n+=(n.length>1?"&":"")+"Amount="+e.amount),this.change.emit(n)}}clean(){this.form.get("warehouseId").setValue(null),this.form.get("amount").setValue(null),this.form.get("providerId").setValue(null),this.form.get("dateInit").setValue(null),this.form.get("dateEnd").setValue(null),this.change.emit("")}}v.\u0275fac=function(i){return new(i||v)(t.Y36(c.qu),t.Y36(Q.E),t.Y36(P.y),t.Y36(Y.l),t.Y36(G.k),t.Y36(M.F))},v.\u0275cmp=t.Xpm({type:v,selectors:[["filter-shopping-gestionary"]],outputs:{change:"emitQuery"},decls:47,vars:23,consts:[["ngNativeValidate","","autocomplete","off",3,"formGroup"],[1,"grid","grid-cols-2","xs:grid-cols-2","sm:grid-cols-12","w-full","min-w-0"],[1,"col-span-1","sm:col-span-4"],[1,"flex","flex-col","flex-auto"],[1,"w-full","pr-3"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"col-span-2","sm:col-span-4"],["nameInput","amount","numberDecimal","2",3,"formControl","label"],[1,"col-span-1","sm:col-span-3"],["color","accent",1,"w-full","pr-3"],["matInput","",3,"formControl","matDatepicker"],["matIconSuffix","",3,"for"],["picker1",""],["color","primary"],["picker2",""],[1,"col-span-2","mt-6","mb-3","sm:col-span-6","sm:mt-6","sm:mt-0"],[1,"flex","w-full","justify-end"],[1,"px-6","ml-3",3,"color","label","icon","withFull","disabled","buttonClick"],[3,"value"]],template:function(i,e){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"mat-divider")(2,"br"),t.TgZ(3,"form",0)(4,"div",1)(5,"div",2)(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),t._uU(9,"Almacen:"),t.qZA(),t.TgZ(10,"mat-select",5),t.YNc(11,j,2,2,"mat-option",6),t.qZA()()()(),t.TgZ(12,"div",2)(13,"div",3)(14,"mat-form-field",4)(15,"mat-label"),t._uU(16,"Proveedor:"),t.qZA(),t.TgZ(17,"mat-select",5),t.YNc(18,E,2,2,"mat-option",6),t.qZA()()()(),t.TgZ(19,"div",7)(20,"div",3),t._UZ(21,"input-decimal",8),t.qZA()()(),t.TgZ(22,"div",1)(23,"div",9)(24,"div",3)(25,"mat-form-field",10)(26,"mat-label"),t._uU(27,"Fecha Inicio Compra:"),t.qZA(),t._UZ(28,"input",11)(29,"mat-datepicker-toggle",12)(30,"mat-datepicker",null,13),t.qZA()()(),t.TgZ(32,"div",9)(33,"div",3)(34,"mat-form-field",10)(35,"mat-label"),t._uU(36,"Fecha Fin Compra:"),t.qZA(),t._UZ(37,"input",11)(38,"mat-datepicker-toggle",12)(39,"mat-datepicker",14,15),t.qZA()()(),t.TgZ(41,"div",16)(42,"div",3)(43,"div",17)(44,"btn-generic",18),t.NdJ("buttonClick",function(){return e.save()}),t.qZA(),t.TgZ(45,"btn-generic",18),t.NdJ("buttonClick",function(){return e.clean()}),t.qZA()()()()(),t._UZ(46,"mat-divider"),t.qZA()()),2&i){const n=t.MAs(31),r=t.MAs(40);t.xp6(3),t.Q6J("formGroup",e.form),t.xp6(7),t.Q6J("formControl",e.control("warehouseId")),t.xp6(1),t.Q6J("ngForOf",e.listWarehouse),t.xp6(6),t.Q6J("formControl",e.control("providerId")),t.xp6(1),t.Q6J("ngForOf",e.listProvider),t.xp6(3),t.Q6J("formControl",e.control("amount"))("label","Monto Compra"),t.xp6(7),t.Q6J("formControl",e.control("dateInit"))("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(8),t.Q6J("formControl",e.control("dateEnd"))("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(6),t.Q6J("color","green")("label","filtrar")("icon","filter_list")("withFull",!1)("disabled",!1),t.xp6(1),t.Q6J("color","secondary")("label","Limpiar")("icon","clear_all")("withFull",!1)("disabled",!1)}},dependencies:[u.sg,c.Fj,c.JJ,c.JL,c.oH,c.sg,f.KE,f.hX,f.R9,w.Nt,O.gD,D.ey,A.d,b.Mq,b.hl,b.nW,B.a,C.e]});var V=s(5830);function H(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"filter-shopping-gestionary",27),t.NdJ("emitQuery",function(r){t.CHM(e);const l=t.oxw();return t.KtG(l.senfilter(r))}),t.qZA()()}}function W(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," No."),t.qZA())}function $(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function z(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," Sucursal "),t.qZA())}function R(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.warehouse.name," ")}}function K(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," Proveedor "),t.qZA())}function X(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.provider.businessName," ")}}function tt(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," Fecha Compra"),t.qZA())}function et(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"dateFormatHours"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.shoppingDate)," ")}}function it(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," Monto"),t.qZA())}function ot(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.amountTotal,"1.2-2")," ")}}function nt(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," Estado "),t.qZA())}function st(o,i){1&o&&t._UZ(0,"chips-faam",31),2&o&&t.Q6J("color","green")("label","Comprado")}function rt(o,i){1&o&&t._UZ(0,"chips-faam",31),2&o&&t.Q6J("color","red")("label","Cancelado")}function lt(o,i){if(1&o&&(t.TgZ(0,"td",29),t.YNc(1,st,1,2,"chips-faam",30),t.YNc(2,rt,1,2,"chips-faam",30),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",1===e.shoppingStatusId),t.xp6(1),t.Q6J("ngIf",2===e.shoppingStatusId)}}function at(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," Acciones "),t.qZA())}function ct(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",29)(1,"mat-icon",32),t.NdJ("click",function(){const l=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.overView(l))}),t._uU(2,"visibility"),t.qZA(),t.TgZ(3,"mat-icon",32),t.NdJ("click",function(){const l=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.lowWarehouse(l))}),t._uU(4,"delete_forever"),t.qZA()()}}function pt(o,i){1&o&&t._UZ(0,"tr",33)}function dt(o,i){1&o&&t._UZ(0,"tr",34)}const ut=function(){return[10,20,50,100,1e3,1e4]},mt=[];class m{constructor(i,e,n){this.service=i,this.router=e,this.dialog=n,this.displayedColumns=["id","warehouse","provider","shoppingDate","amountTotal","isActive","acciones"],this.dataSource=new p.by(mt),this.isFilterVisible=!1,this.totalLength=400,this.data=[],this.objComplete=null,this.listWarehouse=[],this.columns=[],this.actions=[],this.page=0,this.limit=10,this.queryFilter=""}applyFilter(i){i=(i=i.trim()).toLowerCase(),this.dataSource.filter=i}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.service.getAllShopping(this.CurrentPaginator).subscribe(e=>{this.dataSource.data=e.listShopping,this.data=e.listShopping,this.objComplete=e,this.totalLength=e.total}),this.columns=[{prop:"Id",value:"id"},{prop:"Nombre",value:"name"},{prop:"Descripci\xf3n",value:"Description"},{prop:"Ubicaci\xf3n",value:"ubication"}],this.actions=["Ver","Editar","Eliminar"]}createNew(){this.router.navigate(["shopping/shopping/store"])}update(i){this.router.navigate(["sale/sale/store/"+i.id])}overView(i){this.dialog.open(F.I,{data:{id:i.id},maxWidth:"500px",maxHeight:"90vh"}).afterClosed().subscribe(n=>{})}lowWarehouse(i){2===i?.shoppingStatusId?d().fire({position:"center",icon:"warning",title:"\xa1Esta compra ya fue cancelada!",text:"Solo se pueden cancelar las compras activas!",showConfirmButton:!1,timer:1500}):d().fire({title:"Seguro que quiere dar de baja?",text:"Recuerda que no estas eliminando permanentemente!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, dar de Baja!"}).then(e=>{e.isConfirmed&&this.service.lowById(i.id).subscribe(n=>{d().fire("Baja Exitosa!","Su Almacen se dio de baja exitosamente.","success")})})}senfilter(i){this.resetPaginator(),this.queryFilter=i,this.service.getAllShopping(this.CurrentPaginator+i).subscribe(n=>{this.dataSource.data=n.listShopping,this.data=n.listShopping,this.objComplete=n,this.totalLength=n.total})}resetPaginator(){this.page=0,this.limit=10}get CurrentPaginator(){return`?Limit=${this.limit}&Page=${this.page}`}toggleFilter(){this.isFilterVisible=!this.isFilterVisible}}m.\u0275fac=function(i){return new(i||m)(t.Y36(_.s),t.Y36(x.F0),t.Y36(T.uw))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-sales-gestionary"]],viewQuery:function(i,e){if(1&i&&t.Gf(Z.NW,5),2&i){let n;t.iGM(n=t.CRH())&&(e.paginator=n.first)}},decls:43,vars:12,consts:[[1,"contenido"],[1,"flex","flex-col","md:flex-row","items-center","justify-between","dark:bg-gray-700","p-4"],[1,"w-full","mt-4","ml-[-5px]"],[1,"text-2xl","font-semibold","tracking-tight","leading-6"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","flex-col","md:flex-row","items-center","mt-4","md:mt-0"],[1,"px-6","ml-3",3,"color","label","icon","withFull","click"],[1,"flex","items-center","justify-between","mt-2",2,"color","#a2c747 !important"],[1,"flex","items-center",2,"margin-left","8px",3,"click"],[2,"color","#a2c747 !important"],[1,"ml-2","font-bold","text-black",2,"color","#a2c747 !important"],[4,"ngIf"],[1,"mat-elevation-z0","table-responsive","mt-8"],[1,"overflow-x-auto"],["mat-table","",1,"table","min-w-full",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","warehouse"],["matColumnDef","provider"],["matColumnDef","shoppingDate"],["matColumnDef","amountTotal"],["matColumnDef","isActive"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],[3,"emitQuery"],["mat-header-cell",""],["mat-cell",""],[3,"color","label",4,"ngIf"],[3,"color","label"],[1,"mr-2",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Listado de compras"),t.qZA(),t.TgZ(5,"div",4),t._uU(6,"Modulo de gestiones para compra"),t.qZA()(),t.TgZ(7,"div",5)(8,"btn-generic",6),t.NdJ("click",function(){return e.createNew()}),t.qZA()()(),t.TgZ(9,"div",7)(10,"button",8),t.NdJ("click",function(){return e.toggleFilter()}),t.TgZ(11,"mat-icon",9),t._uU(12),t.qZA(),t.TgZ(13,"span",10),t._uU(14),t.qZA()()(),t.YNc(15,H,2,0,"div",11),t.TgZ(16,"div",12)(17,"div",13)(18,"table",14),t.ynx(19,15),t.YNc(20,W,2,0,"th",16),t.YNc(21,$,2,1,"td",17),t.BQk(),t.ynx(22,18),t.YNc(23,z,2,0,"th",16),t.YNc(24,R,2,1,"td",17),t.BQk(),t.ynx(25,19),t.YNc(26,K,2,0,"th",16),t.YNc(27,X,2,1,"td",17),t.BQk(),t.ynx(28,20),t.YNc(29,tt,2,0,"th",16),t.YNc(30,et,3,3,"td",17),t.BQk(),t.ynx(31,21),t.YNc(32,it,2,0,"th",16),t.YNc(33,ot,3,4,"td",17),t.BQk(),t.ynx(34,22),t.YNc(35,nt,2,0,"th",16),t.YNc(36,lt,3,2,"td",17),t.BQk(),t.ynx(37,23),t.YNc(38,at,2,0,"th",16),t.YNc(39,ct,5,0,"td",17),t.BQk(),t.YNc(40,pt,1,0,"tr",24),t.YNc(41,dt,1,0,"tr",25),t.qZA()(),t._UZ(42,"mat-paginator",26),t.qZA()()),2&i&&(t.xp6(8),t.Q6J("color","green")("label","Crear Nuevo")("icon","add")("withFull",!1),t.xp6(4),t.Oqu(e.isFilterVisible?"visibility_off":"visibility"),t.xp6(2),t.Oqu(e.isFilterVisible?"Ocultar filtros":"Mostrar filtros"),t.xp6(1),t.Q6J("ngIf",e.isFilterVisible),t.xp6(3),t.Q6J("dataSource",e.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(11,ut)))},dependencies:[u.O5,y.Hw,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,Z.NW,q.i,C.e,v,u.JJ,V.L],styles:[".contenido[_ngcontent-%COMP%]{width:100%;padding:20px;margin:8px;border-radius:5px;background:#fff;transition:all .3s ease-in-out;box-shadow:0 0 25px #0000001a}"]});var ht=s(8675),gt=s(4004),N=s(6588),J=s(4983),ft=s(2540),U=s(7376),vt=s(746),xt=s(8183);function _t(o,i){1&o&&t._UZ(0,"mat-icon",39),2&o&&t.Q6J("svgIcon","heroicons_solid:badge-check")}function Ct(o,i){1&o&&t._UZ(0,"mat-icon",40),2&o&&t.Q6J("svgIcon","heroicons_solid:badge-check")}function bt(o,i){if(1&o&&t._UZ(0,"img",41),2&o){const e=t.oxw().$implicit;t.Q6J("src","data:image/png;base64,"+e.picture,t.LSH)}}function St(o,i){if(1&o&&t._UZ(0,"img",41),2&o){const e=t.oxw(2);t.Q6J("src","data:image/png;base64,"+e.MyPhoto,t.LSH)}}function Zt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",22),t.NdJ("click",function(){const l=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.selectProduct(l))}),t.TgZ(1,"div",23)(2,"div",17)(3,"div")(4,"div",24),t._uU(5),t.qZA()(),t.TgZ(6,"div",25),t.YNc(7,_t,1,1,"mat-icon",26),t.YNc(8,Ct,1,1,"mat-icon",27),t.qZA()(),t.TgZ(9,"div",28)(10,"div",29),t._uU(11),t.qZA(),t._UZ(12,"div"),t.qZA()(),t.TgZ(13,"div",30),t.YNc(14,bt,1,1,"img",31),t.YNc(15,St,1,1,"ng-template",null,32,t.W1O),t.qZA(),t.TgZ(17,"div",33)(18,"div",34),t._uU(19),t.ALo(20,"truncate"),t.qZA(),t.TgZ(21,"div",35),t._uU(22),t.ALo(23,"truncate"),t.qZA()(),t.TgZ(24,"div",36)(25,"div",37)(26,"label",38),t._uU(27),t.ALo(28,"number"),t.qZA()()()()}if(2&o){const e=i.$implicit,n=t.MAs(16);t.xp6(5),t.hij(" ",null==e||null==e.unitMeasurement?null:e.unitMeasurement.name," "),t.xp6(2),t.Q6J("ngIf",!(null!=e&&e.check)),t.xp6(1),t.Q6J("ngIf",null==e?null:e.check),t.xp6(3),t.hij(" cod:",null==e?null:e.id," "),t.xp6(3),t.Q6J("ngIf",e.picture)("ngIfElse",n),t.xp6(5),t.Oqu(t.xi3(20,9,null==e?null:e.name,15)),t.xp6(3),t.Oqu(t.xi3(23,12,null==e?null:e.description,15)),t.xp6(5),t.hij("Bs.- ",t.xi3(28,15,null==e?null:e.suggestedPriceShopping,"1.2-2"),"")}}function Tt(o,i){1&o&&(t.TgZ(0,"div",42),t._UZ(1,"img",43),t.qZA())}function yt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",44)(2,"div",17)(3,"div",45),t.NdJ("click",function(){const l=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.updateSelect(l))}),t.TgZ(4,"p",46),t._uU(5),t.ALo(6,"truncate"),t.qZA(),t.TgZ(7,"p"),t._uU(8),t.ALo(9,"truncate"),t.qZA()(),t.TgZ(10,"div",47),t.NdJ("click",function(){const l=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.removeItem(l))}),t._UZ(11,"mat-icon",48),t.qZA()(),t.TgZ(12,"div",49),t.NdJ("click",function(){const l=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.updateSelect(l))}),t.TgZ(13,"div",17)(14,"p"),t._uU(15),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"p"),t._uU(18),t.ALo(19,"number"),t.qZA()(),t.TgZ(20,"div",17)(21,"p"),t._uU(22),t.ALo(23,"number"),t.qZA(),t.TgZ(24,"div",50),t._uU(25),t.qZA()(),t.TgZ(26,"div",17)(27,"div",51)(28,"p"),t._uU(29),t.ALo(30,"number"),t.qZA()(),t.TgZ(31,"div",52),t._uU(32),t.ALo(33,"number"),t.qZA()()()()()}if(2&o){const e=i.$implicit;t.xp6(5),t.Oqu(t.xi3(6,9,null==e?null:e.name,25)),t.xp6(3),t.Oqu(t.xi3(9,12,null==e?null:e.description,20)),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:trash"),t.xp6(4),t.hij("Precio: Bs.",t.xi3(16,15,null==e?null:e.price,"1.2-2"),""),t.xp6(3),t.hij("Descuento : ",t.xi3(19,18,null==e?null:e.discount,"1.2-2"),""),t.xp6(4),t.hij("Cantidad : ",t.xi3(23,21,null==e?null:e.count,"1.2-2"),""),t.xp6(3),t.hij(" ",e.unitMeasurementSelect.name," "),t.xp6(4),t.hij("Descuento : ",t.xi3(30,24,null==e?null:e.discount,"1.2-2"),""),t.xp6(3),t.hij(" Sub Total : Bs. ",t.xi3(33,27,null==e?null:e.subTotal,"1.2-2")," ")}}class h{constructor(i,e,n,r,l){this.service=i,this.dialog=e,this.router=n,this.fb=r,this.cdr=l,this.myControl=new c.NI(""),this.options=[],this.totalDinner=0,this.productListSelect=[],this.filter={name:""},this.MyPhoto="",this.someValue=!1,this.barcode="",this.lastKeyTime=0,this.keyTimeout=300,this.isProcessing=!1,this.filter2={name:""},this.someValue=!1,this.form=this.fb.group({id:[null],price:[null],count:[null],discount:[null],subTotal:[null],search:[""]})}onKeydown(i){if(!/[0-9]/.test(i.key))return;const e=Date.now();e-this.lastKeyTime>this.keyTimeout&&(this.barcode=""),this.barcode+=i.key,this.lastKeyTime=e,this.isProcessing||(this.isProcessing=!0,setTimeout(()=>{this.processBarcode(this.barcode),this.barcode="",this.isProcessing=!1},this.keyTimeout))}processBarcode(i){let e=this.productList.filter(n=>n.code===i);null!=e[0]&&null!=e[0]&&this.selectProduct(e[0])}someMethod(){this.someValue=!0,this.cdr.detectChanges()}ngOnInit(){this.MyPhoto=J.k,this.service.getAllProductShopping(1e3,0).subscribe(i=>{this.productList=[...i],this.productList.forEach(e=>{null===e.product?.picture&&(e.product.picture=J.k),e.productId=e?.id,e.name=e?.name,e.description=e?.description,e.category=e?.category?.name})}),this.filteredOptions=this.myControl.valueChanges.pipe((0,ht.O)(""),(0,gt.U)(i=>this._filter(i||"")))}selectProduct(i){this.validateSelectProduct(i.id).length>0?d().fire({icon:"error",title:"Oops...",text:"Ya existe este producto en la lista!"}):this.dialog.open(N.N,{data:{data:i,isNew:true},maxWidth:"90vw",width:"400px",maxHeight:"90vh",disableClose:!0}).afterClosed().subscribe(l=>{let a=l;a?.price&&a.count&&a?.subTotal&&(this.productList.map(I=>{I.id==i.id&&(I.check=!0)}),this.changeProductList(a,true))})}changeProductList(i,e){this.validateSelectProduct(i.id).length>0&&e?d().fire({icon:"error",title:"Oops...",text:"Ya existe este producto en la lista!"}):e?(this.productListSelect.push(i),this.reloadValueTotal()):(this.productListSelect.map(r=>{r.id==i.id&&(r.count=i?.count,r.discount=i?.discount,r.price=i?.price,r.subTotal=i?.subTotal,r.hasEquivalences=i?.hasEquivalences,r.expirationDate=i?.expirationDate,r.unitMeasurementSelect=i?.unitMeasurementSelect)}),this.reloadValueTotal())}reloadValueTotal(){let i=0;this.productListSelect.map(e=>{i+=e.subTotal}),this.totalDinner=i,this.form.get("search").setValue("")}updateSelect(i){this.dialog.open(N.N,{data:{data:i,isNew:!1},maxWidth:"90vw",width:"400px"}).afterClosed().subscribe(r=>{let l=r;this.productList.map(a=>{a.id==i.id&&(a.check=!0)}),this.changeProductList(l,!1)})}validateSelectProduct(i){return this.productListSelect.filter(e=>e.id==i)}_filter(i){const e=i.toLowerCase();return this.options.filter(n=>n.firstName.toLowerCase().includes(e))}get busqueda(){const i=this.form.get("search")?.value?.toLocaleLowerCase()||"";return{name:i,description:i,productId:i,category:i}}getByFilterLocal(i){this.filter2=i}removeItem(i){d().fire({title:"Seguro que quiere quitar?",text:"Una ves quitado, no se revertira!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar!"}).then(e=>{e.isConfirmed&&(this.productListSelect=this.productListSelect.filter(n=>n.id!==i.id),this.productList.map(n=>{n.id==i.id&&(n.check=!1)}),this.reloadValueTotal(),d().fire("Eliminado!","Ese producto no pertenece a la lista de tu compra","success"))})}cancelStore(){d().fire({title:"Seguro que quiere cancelar?",text:"Una cancelado ya se perder\xe1 lo seleccionado!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, Cancelar!"}).then(i=>{i.isConfirmed&&(this.reloadValueTotal(),d().fire("Cancelado!","La nota de venta ah sido cancelada!","success"),this.router.navigate(["sale"]))})}previewStore(){this.dialog.open(ft.l,{autoFocus:!1,maxHeight:"90vh",width:"450px",maxWidth:"90vw",data:{detailProduct:this.productListSelect,total:this.totalDinner,form:this.form.value}}).afterClosed().subscribe(n=>{})}}h.\u0275fac=function(i){return new(i||h)(t.Y36(_.s),t.Y36(T.uw),t.Y36(x.F0),t.Y36(c.qu),t.Y36(t.sBO))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-store-shopping"]],hostBindings:function(i,e){1&i&&t.NdJ("keydown",function(r){return e.onKeydown(r)},!1,t.evT)},decls:39,vars:23,consts:[[1,"base-content"],[1,"contenido"],[1,"grid","grid-cols-1","sm:grid-cols-12","w-full","h-full","min-w-0"],[1,"sm:col-span-8","lg:col-span-8",2,"overflow","hidden"],[1,"w-full","pl-2","pr-2",2,"height","90px","background","#e2e8f0"],[1,"w-full",3,"formGroup"],[1,"w-full",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["placeholder","Buscar por nombre..","matInput","",3,"formControlName"],["itemSize","100",1,"example-viewport","h-full"],[1,"grid","grid-cols-1","sm:grid-cols-8","w-full","min-w-0"],["class","custom-shadow sm:col-span-2 flex flex-col flex-auto p-0 bg-card shadow rounded overflow-hidden p-1 m-1","style","background: #fff !important;",3,"click",4,"ngFor","ngForOf"],[1,"sm:col-span-4","lg:col-span-4",2,"overflow","hidden","box-shadow","0px 4px 6px rgba(0, 0, 0, 0.1)"],[1,"p-2",2,"background","#e2e8f0","height","89px"],[1,"text-center"],[1,"text-lg","font-bold","leading-none",2,"color","#fff"],[1,"text-secondary",2,"color","#fff"],[1,"flex","items-center","justify-between"],[3,"color","label","icon","withFull","disabled","buttonClick"],["class","center",4,"ngIf"],[1,"listProduct"],[4,"ngFor","ngForOf"],[1,"custom-shadow","sm:col-span-2","flex","flex-col","flex-auto","p-0","bg-card","shadow","rounded","overflow-hidden","p-1","m-1",2,"background","#fff !important",3,"click"],[1,"p-2"],[1,"py-0.4","pt-1","pl-2","pr-2","h-6","w-full","px-1","rounded-full","text-xs","text-center","font-semibold","text-green-800","bg-green-100","dark:text-green-50","dark:bg-green-500"],[1,"flex","items-center"],["class","icon-size-5 text-danger-600",3,"svgIcon",4,"ngIf"],["class","icon-size-5 text-green-600",3,"svgIcon",4,"ngIf"],[1,"flex","items-center","justify-between","mt-2"],[2,"font-weight","800","padding-right","10px"],[2,"width","100%","text-align","-webkit-center"],["style","max-width: 230px; max-height: 230px;",3,"src",4,"ngIf","ngIfElse"],["noImage",""],[1,"text-center","mt-1","mb-1"],[1,"text-lg","font-bold","leading-none"],[1,"text-secondary"],[1,"price-product"],[1,"price-product-label","text-center",2,"background","#A2C747"],["for","",2,"color","#fff","font-weight","700"],[1,"icon-size-5","text-danger-600",3,"svgIcon"],[1,"icon-size-5","text-green-600",3,"svgIcon"],[2,"max-width","230px","max-height","230px",3,"src"],[1,"center"],["src","assets/images/ui/empty_cart_icon.svg",2,"width","200px !important"],[1,"itemSelect"],[3,"click"],[2,"font-weight","700","font-size","20px"],[1,"flex","items-center",3,"click"],[1,"icon-size-7","text-red-600",3,"svgIcon"],[1,"",3,"click"],[1,"py-1.5","px-3","rounded-full","text-sm","font-semibold","text-blue-800","bg-blue-100","dark:text-blue-50","dark:bg-blue-500","mt-1"],[1,"py-1.5","px-3","rounded-full","text-sm","font-semibold","text-orange-800","bg-orange-100","dark:text-orange-50","dark:bg-orange-500","mt-1"],[1,"py-1.5","px-3","rounded-full","text-sm","font-semibold","text-green-800","bg-green-100","dark:text-green-50","dark:bg-green-500","mt-1"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"br"),t.TgZ(6,"form",5)(7,"mat-form-field",6),t._UZ(8,"mat-icon",7)(9,"input",8),t.qZA()()(),t.TgZ(10,"cdk-virtual-scroll-viewport",9)(11,"div",10),t.YNc(12,Zt,29,18,"div",11),t.ALo(13,"filter"),t.qZA(),t._UZ(14,"br")(15,"br")(16,"br")(17,"br")(18,"br"),t.qZA()(),t.TgZ(19,"div",12)(20,"div",13)(21,"div",14)(22,"div",15),t._uU(23,"Detalle de Compra "),t.qZA(),t.TgZ(24,"div",16),t._uU(25,"Carrito"),t.qZA()(),t.TgZ(26,"div",17)(27,"btn-generic",18),t.NdJ("buttonClick",function(){return e.cancelStore()}),t.qZA(),t.TgZ(28,"btn-generic",18),t.NdJ("buttonClick",function(){return e.previewStore()}),t.ALo(29,"number"),t.qZA()()(),t.TgZ(30,"cdk-virtual-scroll-viewport",9),t._UZ(31,"mat-divider"),t.YNc(32,Tt,2,0,"div",19),t.TgZ(33,"div",20),t.YNc(34,yt,34,30,"div",21),t.qZA(),t._UZ(35,"br")(36,"br")(37,"br")(38,"br"),t.qZA()()()()()),2&i&&(t.xp6(6),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:search"),t.xp6(1),t.Q6J("formControlName","search"),t.xp6(3),t.Q6J("ngForOf",t.xi3(13,17,e.productList,e.busqueda)),t.xp6(15),t.Q6J("color","secondary")("label","Cancelar")("icon","close")("withFull",!1)("disabled",!1),t.xp6(1),t.Q6J("color","green")("label","Bs. "+t.xi3(29,20,e.totalDinner||0,"1.0-2")+" Pagar")("icon","add_shopping_cart")("withFull",!1)("disabled",!1),t.xp6(4),t.Q6J("ngIf",0===e.productListSelect.length),t.xp6(2),t.Q6J("ngForOf",e.productListSelect))},dependencies:[u.sg,u.O5,c._Y,c.Fj,c.JJ,c.JL,y.Hw,c.sg,c.u,f.KE,f.qo,w.Nt,A.d,U.N7,U.xd,C.e,u.JJ,vt.g,xt.W],styles:[".icon[_ngcontent-%COMP%]{margin:0 10px;color:#000;font-weight:900}.contenido[_ngcontent-%COMP%]{padding:10px;height:100%;border-radius:5px;background:#fff;transition:all .3s ease-in-out;box-shadow:0 0 25px #0000001a}.base-content[_ngcontent-%COMP%]{padding:8px;width:100%}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.itemSelect[_ngcontent-%COMP%]{border:1px solid #f4f4f4;border-radius:2px;padding:5px 10px;margin:2px}.datos[_ngcontent-%COMP%]{padding-left:10px}.itemSelect[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{cursor:pointer}.example-viewport[_ngcontent-%COMP%]{width:100%!important}.custom-shadow[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0003,0 6px 10px #00000026!important}.price-product[_ngcontent-%COMP%]{height:100%;display:flex;align-items:self-end}.price-product-label[_ngcontent-%COMP%]{color:red;width:100%}.center[_ngcontent-%COMP%]{height:78vh;display:flex;justify-content:center;align-items:center}"]});const wt=[{path:"",component:m},{path:"shopping",component:m},{path:"shopping/store",component:h},{path:"shopping/store/:id",component:h}];class g{}g.\u0275fac=function(i){return new(i||g)},g.\u0275mod=t.oAB({type:g}),g.\u0275inj=t.cJS({providers:[_.s],imports:[u.ez,L.m,x.Bz.forChild(wt)]})}}]);